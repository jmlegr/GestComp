# OUT: Importation de la configuration django
# OUT: Importation des modEles django
t1=Graphe_competences.objects.get(competence__nom="s12-a")
f1=Graphe_competences.objects.get(competence__nom="p12")
Graphe_competences.creer_lien(f1,t1)
# OUT: 8 11 6 0
# OUT: CREATE TEMPORARY TABLE IF NOT EXISTS tmp SELECT * FROM  `competences_graphe_competences`  WHERE graphe = 1 AND      lft BETWEEN 13 AND 18 ;UPDATE tmp  SET graphe=0,     tree_id = 10,      niveau = 1,     lft = lft + -2 ,      rgt = rgt + -2 ,      depth = depth - 0 ,      id=0; INSERT INTO `competences_graphe_competences`SELECT * FROM tmp;TRUNCATE  TABLE tmp;
Graphe_competences.liste()
# OUT: 00 00.  palier    (p1 - 1, 26)
# OUT: 00 00. +-- p11    (p2 - 2, 7)
# OUT: 00 00. +--+-- p11-a    (p3 - 3, 4)
# OUT: 00 00. +--+-- p11-b    (p3 - 5, 6)
# OUT: 00 00. +-- p12    (p2 - 8, 17)
# OUT: 00 00. +--+-- p12-a    (p3 - 9, 10)
# OUT: 00 01. +--+-- s12-a    (p3 - 11, 16)
# OUT: 00 01. +--+--+-- s12-a1    (p4 - 12, 13)
# OUT: 00 01. +--+--+-- s12-a2    (p4 - 14, 15)
# OUT: 00 00. +-- p13    (p2 - 18, 23)
# OUT: 00 00. +--+-- p13-a    (p3 - 19, 20)
# OUT: 00 00. +--+-- p13-b    (p3 - 21, 22)
# OUT: 00 00. +-- p14    (p2 - 24, 25)
# OUT: 01 01.  segpa    (p1 - 1, 30)
# OUT: 01 01. +-- s11    (p2 - 2, 11)
# OUT: 01 01. +--+-- s11-a    (p3 - 3, 8)
# OUT: 01 01. +--+--+-- s11-a1    (p4 - 4, 5)
# OUT: 01 01. +--+--+-- s11-a2    (p4 - 6, 7)
# OUT: 01 01. +--+-- s11-b    (p3 - 9, 10)
# OUT: 01 01. +-- s12    (p2 - 12, 19)
# OUT: 01 01. +--+-- s12-a    (p3 - 13, 18)
# OUT: 01 01. +--+--+-- s12-a1    (p4 - 14, 15)
# OUT: 01 01. +--+--+-- s12-a2    (p4 - 16, 17)
# OUT: 01 01. +-- s13    (p2 - 20, 29)
# OUT: 01 01. +--+-- s13-a    (p3 - 21, 22)
# OUT: 01 01. +--+-- s13-b    (p3 - 23, 28)
# OUT: 01 01. +--+--+-- s13-b1    (p4 - 24, 25)
# OUT: 01 01. +--+--+-- s13-b2    (p4 - 26, 27)
f1=Graphe_competences.objects.get(competence__nom="p11-a")
t1=Graphe_competences.objects.get(competence__nom="s11")
Graphe_competences.creer_lien(f1,t1)
# OUT: 3 4 10 0
# OUT: CREATE TEMPORARY TABLE IF NOT EXISTS tmp SELECT * FROM  `competences_graphe_competences`  WHERE graphe = 1 AND      lft BETWEEN 2 AND 11 ;UPDATE tmp  SET graphe=0,     tree_id = 10,      niveau = 1,     lft = lft + 2 ,      rgt = rgt + 2 ,      depth = depth - -2 ,      id=0; INSERT INTO `competences_graphe_competences`SELECT * FROM tmp;TRUNCATE  TABLE tmp;
# OUT: Traceback (most recent call last):
# OUT:   File "<input>", line 1, in <module>
# OUT:   File "/home/duff/test-extjs/GestComp/GestComp/../GestComp/competences/graphe.py", line 96, in creer_lien
# OUT:     cursor.execute(sql, [])
# OUT:   File "/usr/lib/pymodules/python2.6/django/db/backends/util.py", line 15, in execute
# OUT:     return self.cursor.execute(sql, params)
# OUT:   File "/usr/lib/pymodules/python2.6/django/db/backends/mysql/base.py", line 86, in execute
# OUT:     return self.cursor.execute(query, args)
# OUT:   File "/usr/lib/pymodules/python2.6/MySQLdb/cursors.py", line 168, in execute
# OUT:     if not self._defer_warnings: self._warning_check()
# OUT:   File "/usr/lib/pymodules/python2.6/MySQLdb/cursors.py", line 75, in _warning_check
# OUT:     warnings = self._get_db().show_warnings()
# OUT:   File "/usr/lib/pymodules/python2.6/MySQLdb/connections.py", line 300, in show_warnings
# OUT:     self.query("SHOW WARNINGS")
# OUT: DatabaseError: (2014, "Commands out of sync; you can't run this command now")
Graphe_competences.liste()
# OUT: 00 00.  palier    (p1 - 1, 36)
# OUT: 00 00. +-- p11    (p2 - 2, 17)
# OUT: 00 00. +--+-- p11-a    (p3 - 3, 14)
# OUT: 00 01. +--+--+-- s11    (p4 - 4, 13)
# OUT: 00 01. +--+--+--+-- s11-a    (p5 - 5, 10)
# OUT: 00 01. +--+--+--+--+-- s11-a1    (p6 - 6, 7)
# OUT: 00 01. +--+--+--+--+-- s11-a2    (p6 - 8, 9)
# OUT: 00 01. +--+--+--+-- s11-b    (p5 - 11, 12)
# OUT: 00 00. +--+-- p11-b    (p3 - 15, 16)
# OUT: 00 00. +-- p12    (p2 - 18, 27)
# OUT: 00 00. +--+-- p12-a    (p3 - 19, 20)
# OUT: 00 01. +--+-- s12-a    (p3 - 21, 26)
# OUT: 00 01. +--+--+-- s12-a1    (p4 - 22, 23)
# OUT: 00 01. +--+--+-- s12-a2    (p4 - 24, 25)
# OUT: 00 00. +-- p13    (p2 - 28, 33)
# OUT: 00 00. +--+-- p13-a    (p3 - 29, 30)
# OUT: 00 00. +--+-- p13-b    (p3 - 31, 32)
# OUT: 00 00. +-- p14    (p2 - 34, 35)
# OUT: 01 01.  segpa    (p1 - 1, 30)
# OUT: 01 01. +-- s11    (p2 - 2, 11)
# OUT: 01 01. +--+-- s11-a    (p3 - 3, 8)
# OUT: 01 01. +--+--+-- s11-a1    (p4 - 4, 5)
# OUT: 01 01. +--+--+-- s11-a2    (p4 - 6, 7)
# OUT: 01 01. +--+-- s11-b    (p3 - 9, 10)
# OUT: 01 01. +-- s12    (p2 - 12, 19)
# OUT: 01 01. +--+-- s12-a    (p3 - 13, 18)
# OUT: 01 01. +--+--+-- s12-a1    (p4 - 14, 15)
# OUT: 01 01. +--+--+-- s12-a2    (p4 - 16, 17)
# OUT: 01 01. +-- s13    (p2 - 20, 29)
# OUT: 01 01. +--+-- s13-a    (p3 - 21, 22)
# OUT: 01 01. +--+-- s13-b    (p3 - 23, 28)
# OUT: 01 01. +--+--+-- s13-b1    (p4 - 24, 25)
# OUT: 01 01. +--+--+-- s13-b2    (p4 - 26, 27)
